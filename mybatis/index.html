<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Mybatis - miaobuyi&#39;s blog</title><meta name="Description" content=""><meta property="og:title" content="Mybatis" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://miaobuyi.web/mybatis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-21T17:51:18+08:00" />
<meta property="article:modified_time" content="2021-09-21T17:51:18+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Mybatis"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://miaobuyi.web/mybatis/" /><link rel="prev" href="https://miaobuyi.web/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" /><link rel="next" href="https://miaobuyi.web/springmvc/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Mybatis",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/miaobuyi.web\/mybatis\/"
        },"genre": "posts","keywords": "Mybatis","wordcount":  9476 ,
        "url": "https:\/\/miaobuyi.web\/mybatis\/","datePublished": "2021-09-21T17:51:18+08:00","dateModified": "2021-09-21T17:51:18+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "喵不易"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="miaobuyi&#39;s blog">LoveIt</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="miaobuyi&#39;s blog">LoveIt</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Mybatis</h1><h2 class="single-subtitle">Mybatis</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>喵不易</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E6%A1%86%E6%9E%B6/"><i class="far fa-folder fa-fw"></i>框架</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-09-21">2021-09-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 9476 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 19 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#mybatis">Mybatis</a></li>
    <li><a href="#1第一个mybatis程序">1、第一个Mybatis程序</a>
      <ul>
        <li><a href="#导入maven依赖">导入maven依赖</a></li>
        <li><a href="#便携mybatis的核心配置文件">便携mybatis的核心配置文件</a></li>
        <li><a href="#编写mybatis工具类">编写mybatis工具类</a></li>
        <li><a href="#实体类">实体类</a></li>
        <li><a href="#mapper-接口">Mapper 接口</a></li>
        <li><a href="#xml文件里不要写中文注释要报错">XML文件里不要写中文注释要报错</a></li>
        <li><a href="#maven">maven</a></li>
        <li><a href="#测试">测试</a></li>
      </ul>
    </li>
    <li><a href="#2crud">2、CRUD</a>
      <ul>
        <li><a href="#1namesapce">1、namesapce</a></li>
        <li><a href="#2select">2、select</a></li>
        <li><a href="#3insert">3、insert</a></li>
        <li><a href="#4update">4、update</a></li>
        <li><a href="#5delete">5、delete</a></li>
        <li><a href="#6分析错误">6、分析错误</a></li>
        <li><a href="#7万能map">7、万能map</a></li>
        <li><a href="#8思考题">8、思考题</a></li>
      </ul>
    </li>
    <li><a href="#3配置解析">3、配置解析</a>
      <ul>
        <li><a href="#1核心配置文件">1、核心配置文件</a></li>
        <li><a href="#2环境配置environments">2、环境配置（environments）</a></li>
        <li><a href="#3属性properties">3、属性（properties）</a></li>
        <li><a href="#4类型别名typealiases">4、类型别名(typeAliases)</a></li>
        <li><a href="#5设置">5、设置</a>
          <ul>
            <li><a href="#6其他设置">6、其他设置</a></li>
          </ul>
        </li>
        <li><a href="#7映射器mappers">7、映射器（mappers）</a></li>
        <li><a href="#8生命周期和作用域">8、生命周期和作用域</a></li>
      </ul>
    </li>
    <li><a href="#4解决属性名和字段名不一致的问题">4、解决属性名和字段名不一致的问题</a>
      <ul>
        <li><a href="#1问题">1、问题</a></li>
        <li><a href="#2resultmap">2、resultMap</a></li>
      </ul>
    </li>
    <li><a href="#5日志">5、日志</a>
      <ul>
        <li><a href="#1日志工程">1、日志工程</a></li>
        <li><a href="#2log4j">2、LOG4J</a></li>
      </ul>
    </li>
    <li><a href="#6分页">6、分页</a>
      <ul>
        <li><a href="#1使用limit分页">1、使用Limit分页</a></li>
        <li><a href="#2rowbounds了解">2、RowBounds【了解】</a></li>
        <li><a href="#3插件分页了解">3、插件分页【了解】</a></li>
      </ul>
    </li>
    <li><a href="#7使用注解开发">7、使用注解开发</a>
      <ul>
        <li><a href="#1面向接口编程">1、面向接口编程</a></li>
        <li><a href="#2使用注解开发">2、使用注解开发</a></li>
      </ul>
    </li>
    <li><a href="#8lombok">8、Lombok</a></li>
    <li><a href="#9多对一处理">9、多对一处理</a>
      <ul>
        <li><a href="#测试环境搭建">测试环境搭建</a></li>
        <li><a href="#按照查询嵌套处理">按照查询嵌套处理</a></li>
        <li><a href="#按照结果嵌套处理">按照结果嵌套处理</a></li>
      </ul>
    </li>
    <li><a href="#10一对多处理">10、一对多处理</a>
      <ul>
        <li><a href="#环境搭建">环境搭建</a></li>
        <li><a href="#按照过嵌套处理">按照过嵌套处理</a></li>
        <li><a href="#按查询嵌套处理">按查询嵌套处理</a></li>
      </ul>
    </li>
    <li><a href="#11动态sql">11、动态SQL</a>
      <ul>
        <li><a href="#搭建环境">搭建环境</a></li>
        <li><a href="#if">IF</a></li>
        <li><a href="#choose-when-otherwise">choose (when， otherwise)</a></li>
        <li><a href="#trim-where-settrim可以自定义">trim (where， set)【trim可以自定义】</a></li>
        <li><a href="#sql片段">SQL片段</a></li>
        <li><a href="#foreach">Foreach</a></li>
      </ul>
    </li>
    <li><a href="#12缓存">12、缓存</a>
      <ul>
        <li><a href="#1简介">1、简介</a></li>
        <li><a href="#2mybatis缓存">2、Mybatis缓存</a></li>
        <li><a href="#3一级缓存">3、一级缓存</a></li>
        <li><a href="#4-二级缓存">4、 二级缓存</a></li>
        <li><a href="#5缓存原理">5、缓存原理</a></li>
        <li><a href="#6自定义缓存-ehcache">6、自定义缓存-ehcache</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="mybatis">Mybatis</h2>
<h2 id="1第一个mybatis程序">1、第一个Mybatis程序</h2>
<h3 id="导入maven依赖">导入maven依赖</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
<span class="c">&lt;!--      父工程  --&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>cn.miaobuyi<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>ssm<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>

    <span class="nt">&lt;modules&gt;</span>
        <span class="nt">&lt;module&gt;</span>mybatis<span class="nt">&lt;/module&gt;</span>
    <span class="nt">&lt;/modules&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-context<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>5.3.8<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.5.7<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>5.1.47<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>4.13<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;/dependencies&gt;</span>
    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>11<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>11<span class="nt">&lt;/maven.compiler.target&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>


<span class="nt">&lt;/project&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="便携mybatis的核心配置文件">便携mybatis的核心配置文件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/dataSource&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;/environments&gt;</span>
<span class="c">&lt;!--  每一个Mapper.XML都需要在Mybatis核心配置文件中注册！  --&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;mapper</span>  <span class="na">resource=</span><span class="s">&#34;com/miaobuyi/mapper/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="编写mybatis工具类">编写mybatis工具类</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.miaobuyi.utils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="c1">//sqlSessionFactory --&gt; sqlSession
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MybatisUtils</span> <span class="o">{</span>
    <span class="kd">private</span>  <span class="kd">static</span> <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="kd">static</span> <span class="o">{</span>
       <span class="k">try</span> <span class="o">{</span>
           <span class="c1">//使用Mybatis第一步：获取sqlSessionFactory对象
</span><span class="c1"></span>            <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
            <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">//既然有了 ，顾名思义，我们就可以从中获得SqlSession的实例了。
</span><span class="c1"></span>    <span class="c1">//SqlSession 完全包含了面向数据库执行SQL命令所需的所有方法
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SqlSession</span> <span class="nf">getSqlSeesion</span><span class="o">(){</span>
        <span class="k">return</span>  <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="实体类">实体类</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.miaobuyi.pojo</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPwd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPwd</span><span class="o">(</span><span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="mapper-接口">Mapper 接口</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.miaobuyi.mapper</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.miaobuyi.pojo.User</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="xml文件里不要写中文注释要报错">XML文件里不要写中文注释要报错</h3>
<p>接口实现类 由原来的UserMapperImpl转变成为一个Mapper配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="c">&lt;!--namespace=绑定一个对应的Dao/Mappser接口--&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.miaobuyi.mapper.UserMapper&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--selecte查询语句--&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserList&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.miaobuyi.pojo.User&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.user
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="maven">maven</h3>
<p>maven由于他的约定大于配置，我们之后可能遇到我们配置文件，无法被到处或者生效的问题；解决方案pom.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 在build中配置resource。来防止我们资源导出失败的问题   --&gt;</span>
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;resources&gt;</span>
        <span class="nt">&lt;resource&gt;</span>
            <span class="nt">&lt;directory&gt;</span>src/main/resource<span class="nt">&lt;/directory&gt;</span>
            <span class="nt">&lt;includes&gt;</span>
                <span class="nt">&lt;include&gt;</span>**/*.properties<span class="nt">&lt;/include&gt;</span>
                <span class="nt">&lt;include&gt;</span>**/*.xml<span class="nt">&lt;/include&gt;</span>
            <span class="nt">&lt;/includes&gt;</span>
            <span class="nt">&lt;filtering&gt;</span>true<span class="nt">&lt;/filtering&gt;</span>
        <span class="nt">&lt;/resource&gt;</span>
        <span class="nt">&lt;resource&gt;</span>
            <span class="nt">&lt;directory&gt;</span>src/main/java<span class="nt">&lt;/directory&gt;</span>
            <span class="nt">&lt;includes&gt;</span>
                <span class="nt">&lt;include&gt;</span>**/*.properties<span class="nt">&lt;/include&gt;</span>
                <span class="nt">&lt;include&gt;</span>**/*.xml<span class="nt">&lt;/include&gt;</span>
            <span class="nt">&lt;/includes&gt;</span>
            <span class="nt">&lt;filtering&gt;</span>true<span class="nt">&lt;/filtering&gt;</span>
        <span class="nt">&lt;/resource&gt;</span>
    <span class="nt">&lt;/resources&gt;</span>
<span class="nt">&lt;/build&gt;</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="测试">测试</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.miaobuyi.mapper</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.miaobuyi.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.miaobuyi.utils.MybatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserMapperTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="c1">//第一步获取SqlSession对象
</span><span class="c1"></span>        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="c1">//执行sql  方式1：getMapper
</span><span class="c1"></span>        <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserList</span><span class="o">();</span>

        <span class="c1">//方式2 老方式
</span><span class="c1"></span>        <span class="c1">//userList =  sqlSession.selectList(&#34;com.miaobuyi.mapper.UserMapper.getUserList&#34;);
</span><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="n">User</span> <span class="n">user</span> <span class="o">:</span><span class="n">userList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">//关闭SqlSession
</span><span class="c1"></span>        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="2crud">2、CRUD</h2>
<h3 id="1namesapce">1、namesapce</h3>
<p>namespace中的包名要和Dao/mapper接口中的包名一致！</p>
<h3 id="2select">2、select</h3>
<p>选择，查询一句：</p>
<ul>
<li>id：就是对应namespace中的方法名</li>
<li>resultType：sql语句执行的返回值</li>
<li>parameterTpey：参数类型</li>
</ul>
<ol>
<li>
<p>编写接口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">//根据ID查询用户
</span><span class="c1"></span>    <span class="n">User</span> <span class="nf">getUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编写对应mapper中的sql语句</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.miaobuyi.pojo.User&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.user where id = #{id}
    <span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"> <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserById</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getUserById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="3insert">3、insert</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.miaobuyi.pojo.User&#34;</span><span class="nt">&gt;</span>
        insert  into mybatis.user (id,name,pwd)values (#{id},#{name},#{pwd})
    <span class="nt">&lt;/insert&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="4update">4、update</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.miaobuyi.pojo.User&#34;</span><span class="nt">&gt;</span>
        update mybatis.user set name = #{name},pwd=#{pwd} where id=#{id};
    <span class="nt">&lt;/update&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="5delete">5、delete</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span><span class="nt">&gt;</span>
        delete from mybatis.user where id=#{id}
    <span class="nt">&lt;/delete&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：增删改需要提交事务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span><span class="c1">//工具类中  自动开启提交事务
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="6分析错误">6、分析错误</h3>
<ul>
<li>
<p>标签不要匹配错误</p>
</li>
<li>
<p>resource绑定mapper，需要使用路径</p>
</li>
<li>
<p>程序配置文件必须符合规范</p>
</li>
<li>
<p>NullPointerException，没有注册到资源</p>
</li>
<li>
<p>输出的xml文件中存在中文乱码问题（最好不要写注释）</p>
</li>
<li>
<p>maven资源没有导出问题</p>
</li>
</ul>
<h3 id="7万能map">7、万能map</h3>
<p>假设，我们的实体类，或者数据库中的表，字段或者参数过多，我们应当考虑使用map！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="c1">//万能map
</span><span class="c1"></span>    <span class="n">User</span> <span class="nf">addUser2</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addUser2&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
        insert  into mybatis.user (id,name,pwd)values (#{userid},#{uerName},#{password})
    <span class="nt">&lt;/insert&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"> <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addUser2</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;userid&#34;</span><span class="o">,</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;userName&#34;</span><span class="o">,</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">,</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">mapper</span><span class="o">.</span><span class="na">addUser2</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Map传递参数时，在sql中直接取出key即可</p>
<p>对象传递参数，直接在sql中取对象属性即可</p>
<p>只有一个基本类型参数的情况下，可以直接在sql中取到</p>
<p>多个参数用Map，或者<strong>注解</strong></p>
<h3 id="8思考题">8、思考题</h3>
<p>模糊查询怎么写？</p>
<ol>
<li>
<p>java代码执行的时候，传递通配符% %</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getUserLike</span><span class="o">(</span><span class="s">&#34;%李%&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在sql拼接中使用通配符！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mybatis</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s2">&#34;%&#34;</span><span class="o">#</span><span class="err">{</span><span class="n">value</span><span class="err">}</span><span class="s2">&#34;%&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="3配置解析">3、配置解析</h2>
<h3 id="1核心配置文件">1、核心配置文件</h3>
<ul>
<li>
<p>mybatis-config.xml</p>
</li>
<li>
<p>Mybatis的配置文件包含了会深深影响Mybatis行为的设置和属性信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"> configuration（配置）
 properties（属性）
 settings（设置）
 typeAliases（类型别名）
 typeHandlers（类型处理器）
 objectFactory（对象工厂）
 plugins（插件）
 environments（环境配置）
 environment（环境变量）
 transactionManager（事务管理器）
 dataSource（数据源）
 databaseIdProvider（数据库厂商标识）
 mappers（映射器）
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="2环境配置environments">2、环境配置（environments）</h3>
<p>MyBatis 可以配置成适应多种环境</p>
<p><strong>不过要记住：尽管可以配置多个环境，但每个 SqlSessionFactory 实例只能选择一种环境。</strong></p>
<p>学会使用多套配置运行环境</p>
<p>mybatis默认的食物管理器就是JDBC，连接池：POOLED</p>
<h3 id="3属性properties">3、属性（properties）</h3>
<p>我们可以通过properties属性来实现引用配置文件</p>
<p>这些属性可以在外部进行配置，并可以进行动态替换。你既可以在典型的 Java 属性文件中配置这些属性，也可以在 properties 元素的子元素中设置。</p>
<p>db.properties</p>
<p>编写一个配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis?useSSL=false&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8
username=root
password=123456
</code></pre></td></tr></table>
</div>
</div><p>在核心配置文件中引用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>可以直接引入外部文件</li>
<li>可以在其中增加一些配置属性</li>
<li>如果两个文件有同一个字段，先读取properties元素体内指定的属性，然后根据properties元素中resource属性读取类路径下属性文件，或根据url属性指定的路径读取属性文件，并覆盖之前读取过得同名属性，最后读取作为方法参数传递的属性，并覆盖之前读取过的同名属性</li>
</ul>
<h3 id="4类型别名typealiases">4、类型别名(typeAliases)</h3>
<ul>
<li>类型别名是java类型设置一个短的名字</li>
<li>它仅用于 XML 配置，意在降低冗余的全限定类名书写</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">&#34;com.miaobuyi.pojo.User&#34;</span> <span class="na">alias=</span><span class="s">&#34;User&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean</p>
<p>扫描实体类的包，它的默认别名就为这个类的类名，首字母小写！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;typeAliases&gt;</span>
       <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.miaobuyi.pojo&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>在实体类比较少的时候使用第一种方式</p>
<p>如果实体类十分多，建议使用第二种</p>
<p>第一种可以DIY别名，第二种不行，如果非要改，需要在实体上增加注解</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Alias</span><span class="o">(</span><span class="s">&#34;user&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="5设置">5、设置</h3>
<p>这是MyBatis中极为重要的调整设置，它们会改变MyBatis的运行时行为。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190420538.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190420538.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190420538.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190420538.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210714190420538.png"
        title="image-20210714190420538" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190451330.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190451330.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190451330.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714190451330.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210714190451330.png"
        title="image-20210714190451330" /></p>
<h4 id="6其他设置">6、其他设置</h4>
<ul>
<li>
<p>typeHandlers（类型处理器）</p>
</li>
<li>
<p>objectFactory（对象工厂）</p>
</li>
<li>
<p>plugins（插件）</p>
</li>
<li>
<p>mybatis-generator-core</p>
</li>
<li>
<p>mybatis-plus</p>
</li>
<li>
<p>通用mapper</p>
</li>
</ul>
<h3 id="7映射器mappers">7、映射器（mappers）</h3>
<p>MapperRegistry：注册绑定我们的Mapper文件；</p>
<p>方式一：【推荐使用】</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--  每一个Mapper.XML都需要在Mybatis核心配置文件中注册！  --&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;mapper</span>  <span class="na">resource=</span><span class="s">&#34;com/miaobuyi/mapper/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.miaobuyi.mapper.UserMapper&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>方式二：使用class文件绑定注册</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.miaobuyi.mapper.UserMapper&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>注意点：</p>
<ul>
<li>接口和他的Mapper配置文件必须同名！</li>
<li>接口和他的Mapper配置文件必须在同一个包下！</li>
</ul>
<p>方式三：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.miaobuyi.mapper&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>接口和他的Mapper配置文件必须同名！（UserMapper接口和UserMapper.xml）</li>
<li>接口和他的Mapper配置文件必须在同一个包下！</li>
</ul>
<h3 id="8生命周期和作用域">8、生命周期和作用域</h3>
<p>作用域和生命周期是至关重要的，因为错误的使用会导致非常严重的<strong>并发问题</strong>。</p>
<p><strong>SqlSessionFactoryBuilder</strong>：</p>
<ul>
<li>一旦创建了 SqlSessionFactory，就不再需要它了</li>
<li>局部变量</li>
</ul>
<p><strong>SqlSessionFactory</strong>：</p>
<ul>
<li>说白了就是可以想象为：数据链接池</li>
<li>SqlSessionFactory一旦被创建就应该在应用的运行期间一直存在，<strong>没有任何理由丢弃它或重新创建另一个实例</strong></li>
<li>因此 SqlSessionFactory 的最佳作用域是应用作用域。</li>
<li>有很多方法可以做到，最简单的就是使用<strong>单例模式</strong>或者静态单例模式</li>
</ul>
<p><strong>SqlSession</strong></p>
<ul>
<li>链接到连接池的一个请求！</li>
<li>SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的作用域是请求或方法作用域</li>
<li>用完之后需要赶紧关闭，否则资源被占用！</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194447645.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194447645.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194447645.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194447645.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210714194447645.png"
        title="image-20210714194447645" /></p>
<p>这里面的每一个Mapper，就代表一个具体的业务！</p>
<h2 id="4解决属性名和字段名不一致的问题">4、解决属性名和字段名不一致的问题</h2>
<h3 id="1问题">1、问题</h3>
<p>数据库中的字段</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194722061.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194722061.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194722061.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714194722061.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210714194722061.png"
        title="image-20210714194722061" /></p>
<p>新建一个项目，拷贝之前的，测试实体类字段不一致的情况</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>测试出现问题</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714195944486.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714195944486.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714195944486.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210714195944486.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210714195944486.png"
        title="image-20210714195944486" /></p>
<p>解决办法</p>
<ul>
<li>
<p>起别名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="w">
</span><span class="w"></span><span class="o">//</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mybatis</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">#</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="o">//</span><span class="err">类型处理器</span><span class="w">
</span><span class="w"></span><span class="o">//</span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">pwd</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mybatis</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">#</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="o">```</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="2resultmap">2、resultMap</h3>
<p>结果集映射</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">id name pwd
id name password
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="c">&lt;!--结果集映射--&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;UserMap&#34;</span> <span class="na">type=</span><span class="s">&#34;user&#34;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!--column数据库中的字段，property实体类中的属性--&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;pwd&#34;</span> <span class="na">property=</span><span class="s">&#34;password&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
     <span class="nt">&lt;/resultMap&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.user where id = #{id}
    <span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>resultMap</code> 元素是 MyBatis 中最重要最强大的元素</li>
<li><code>ResultMap</code> 的设计思想是，对简单的语句做到零配置，对于复杂一点的语句，只需要描述语句之间的关系就行了。</li>
<li><code>ResultMap</code>的优秀之处,虽然你已经对他相当了解了，但是根本就不需要显式地配置它们。</li>
</ul>
<h2 id="5日志">5、日志</h2>
<h3 id="1日志工程">1、日志工程</h3>
<p>如果一个数据库操作，出现了异常，我们需要配错，日志就是最好的助手</p>
<p>曾经：sout，debug</p>
<p>现在：日志工厂！</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715124954090.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715124954090.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715124954090.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715124954090.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715124954090.png"
        title="image-20210715124954090" /></p>
<ul>
<li>SLF4J</li>
<li>LOG4J 【掌握】</li>
<li>LOG4J2</li>
<li>JDK_LOGGING</li>
<li>COMMONS_LOGGING</li>
<li>STDOUT_LOGGING 【掌握】</li>
<li>NO_LOGGING</li>
</ul>
<p>在mybatis中具体使用哪一个日志实现，在设置中设定</p>
<p><strong>STDOUT_LOGGING标准日志输出</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715125831931.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715125831931.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715125831931.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715125831931.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715125831931.png"
        title="image-20210715125831931" /></p>
<h3 id="2log4j">2、LOG4J</h3>
<p>什么是LOG4J ？</p>
<ul>
<li>Log4j是<a href="https://baike.baidu.com/item/Apache/8512995" target="_blank" rel="noopener noreffer">Apache</a>的一个开源项目，通过使用Log4j，我们可以控制日志信息输送的目的地是<a href="https://baike.baidu.com/item/%e6%8e%a7%e5%88%b6%e5%8f%b0/2438626" target="_blank" rel="noopener noreffer">控制台</a>、文件、<a href="https://baike.baidu.com/item/GUI" target="_blank" rel="noopener noreffer">GUI</a>组件</li>
<li>通过定义每一条日志信息的级别，我们能够更加细致地控制日志的生成过程。</li>
<li>通过一个<a href="https://baike.baidu.com/item/%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6/286550" target="_blank" rel="noopener noreffer">配置文件</a>来灵活地进行配置，而不需要修改应用的代码。</li>
</ul>
<ol>
<li>
<p>先导入LOG4J 的包、</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>log4j<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>log4j<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.2.17<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>log4j.properties</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">#将等级为DEBUG的日志信息输出到console和file这两个目的地，console和file的定义在下面的代码
log4j.rootLogger=DEBUG,console,file

#控制台输出的相关设置
log4j.appender.console = org.apache.log4j.ConsoleAppender
log4j.appender.console.Target = System.out
log4j.appender.console.Threshold=DEBUG
log4j.appender.console.layout = org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=[%c]-%m%n

#文件输出的相关设置
log4j.appender.file = org.apache.log4j.RollingFileAppender
log4j.appender.file.File=./log/miaobuyi.log
log4j.appender.file.MaxFileSize=10mb
log4j.appender.file.Threshold=DEBUG
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=[%p][%d{yy-MM-dd}][%c]%m%n

#日志输出级别
log4j.logger.org.mybatis=DEBUG
log4j.logger.java.sql=DEBUG
log4j.logger.java.sql.Statement=DEBUG
log4j.logger.java.sql.ResultSet=DEBUG
log4j.logger.java.sql.PreparedStatement=DEBUG
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置log4j为日志的实现</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;LOG4J&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>log4j的使用！直接运行刚才的查询</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132513047.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132513047.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132513047.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132513047.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715132513047.png"
        title="image-20210715132513047" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132537236.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132537236.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132537236.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715132537236.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715132537236.png"
        title="image-20210715132537236" /></p>
</li>
</ol>
<p><strong>简单使用</strong></p>
<ol>
<li>
<p>在要使用log4j类中，导入包 import org.apache.log4j.Logger;</p>
</li>
<li>
<p>日志对象，参数为当前类的class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="kd">static</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">UserMapperTest</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>日志级别</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;info:进入了testLog4j&#34;</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&#34;debug:进入了testLog4j&#34;</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;error:进入了testLog4j&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="6分页">6、分页</h2>
<p><strong>思考：为什么要分页</strong></p>
<ul>
<li>减少以数据的处理量</li>
</ul>
<h3 id="1使用limit分页">1、使用Limit分页</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="err">语法：</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="n">startIndex</span><span class="p">,</span><span class="n">pageSize</span><span class="w">
</span><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mybatis</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="o">#</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>使用Mybatis分页，核心SQL</p>
<ol>
<li>
<p>接口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    List<span class="nt">&lt;User&gt;</span> getUserByLimit(Map<span class="nt">&lt;String</span><span class="err">,Integer</span><span class="nt">&gt;</span> map);
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Mapper.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserByLimit&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.user limit #{startIndex},#{pageSize}
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserByLimit</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;();</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;startIndex&#34;</span><span class="o">,</span><span class="n">0</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;pageSize&#34;</span><span class="o">,</span><span class="n">2</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getUserByLimit</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">:</span><span class="n">userList</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="2rowbounds了解">2、RowBounds【了解】</h3>
<p>不再使用SQL实现分页</p>
<ol>
<li>
<p>接口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserByRowBounds</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>mapper.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserByRowBounds&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.user
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserByRowBounds</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="c1">//RowBounds实现
</span><span class="c1"></span>    <span class="n">RowBounds</span> <span class="n">rowBounds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RowBounds</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>

    <span class="c1">//通过java代码层面实现分页
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">&#34;com.miaobuyi.mapper.UserMapper.getUserByRowBounds&#34;</span><span class="o">,</span><span class="kc">null</span><span class="o">,</span><span class="n">rowBounds</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">:</span><span class="n">userList</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="3插件分页了解">3、插件分页【了解】</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715165613496.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715165613496.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715165613496.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715165613496.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715165613496.png"
        title="image-20210715165613496" /></p>
<h2 id="7使用注解开发">7、使用注解开发</h2>
<h3 id="1面向接口编程">1、面向接口编程</h3>
<p>大家之前都学过面向对象编程，也学习过接口，但在真正的开发中，很多时候我们会选择面向接口编程</p>
<p><strong>-根本原因∶解耦，可拓展，提高复用，分层开发中，上层不用管具体的实现，大家都遵守共同的标准，使得开发变得容易，规范性更好</strong></p>
<ul>
<li>
<p>在一个面向对象的系统中，系统的各种功能是由许许多多的不同对象协作完成的。在这种情况下.各个对象内部是如何实现自己的,对系统设计人员来讲就不那么重要了;</p>
</li>
<li>
<p>而各个对象之间的协作关系则成为系统设计的关键。小到不同类之间的通信，大到各模块之间的交互，在系统设计之初都是要着重考虑的，这也是系统设计的主要工作内容。面向接口编程就是指按照这种思想来编程。</p>
</li>
</ul>
<p><strong>关于接口的理解</strong></p>
<ul>
<li>
<p>接口从更深层次的理解，应是定义(规范，约束）与实现(名实分离的原则）的分离。</p>
</li>
<li>
<p>接口的本身反映了系统设计人员对系统的抽象理解。</p>
</li>
<li>
<p>接口应有两类:</p>
<ul>
<li>第一类是对一个个体的抽象，它可对应为一个抽象体(abstract class);</li>
<li>第二类是对一个个体某一方面的抽象，即形成一个抽象面( interface) ;</li>
</ul>
</li>
<li>
<p>一个体有可能有多个抽象面。抽象体与抽象面是有区别的。</p>
</li>
</ul>
<p><strong>三个面向区别</strong></p>
<ul>
<li>
<p>面向对象是指，我们考虑问题时，以对象为单位,考虑它的属性及方法.</p>
</li>
<li>
<p>面向过程是指，我们考虑问题时，以一个具体的流程(事务过程)为单位，考虑它的实现.</p>
</li>
<li>
<p>接口设计与非接口设计是针对复用技术而言的，与面向对象(过程)不是一一个问题.更多的体现就是对系统整体的</p>
</li>
</ul>
<h3 id="2使用注解开发">2、使用注解开发</h3>
<ol>
<li>
<p>注解在接口上实现</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from user&#34;</span><span class="o">)</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUsers</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>需要在核心配置文件中绑定接口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--    绑定接口--&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.miaobuyi.mapper.UserMapper&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getUsers</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">:</span><span class="n">userList</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>本质：反射机制实现</p>
<p>底层：动态代理！</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715175854323.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715175854323.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715175854323.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210715175854323.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210715175854323.png"
        title="image-20210715175854323" /></p>
<p><strong>Mybatis详细的执行流程！</strong></p>
<h2 id="8lombok">8、Lombok</h2>
<p>使用步骤</p>
<ol>
<li>
<p>在IDEA中安装Lombok</p>
</li>
<li>
<p>在项目中导入Lombok的jar包</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.18.20<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

</code></pre></td></tr></table>
</div>
</div></li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Getter</span> <span class="n">and</span> <span class="nd">@Setter</span>
<span class="nd">@FieldNameConstants</span>
<span class="nd">@ToString</span>
<span class="nd">@EqualsAndHashCode</span>
<span class="nd">@AllArgsConstructor</span><span class="o">,</span> <span class="nd">@RequiredArgsConstructor</span> <span class="n">and</span> <span class="nd">@NoArgsConstructor</span>
<span class="nd">@Log</span><span class="o">,</span> <span class="nd">@Log4j</span><span class="o">,</span> <span class="nd">@Log4j2</span><span class="o">,</span> <span class="nd">@Slf4j</span><span class="o">,</span> <span class="nd">@XSlf4j</span><span class="o">,</span> <span class="nd">@CommonsLog</span><span class="o">,</span> <span class="nd">@JBossLog</span><span class="o">,</span> <span class="nd">@Flogger</span><span class="o">,</span> <span class="nd">@CustomLog</span>
<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@SuperBuilder</span>
<span class="nd">@Singular</span>
<span class="nd">@Delegate</span>
<span class="nd">@Value</span>
<span class="nd">@Accessors</span>
<span class="nd">@Wither</span>
<span class="nd">@With</span>
<span class="nd">@SneakyThrows</span>
<span class="nd">@val</span>
<span class="nd">@var</span>
<span class="n">experimental</span> <span class="nd">@var</span>
<span class="nd">@UtilityClass</span>
<span class="nd">@ExtensionMethod</span> <span class="o">(</span><span class="n">Experimental</span><span class="o">,</span> <span class="n">activate</span> <span class="n">manually</span> <span class="n">in</span> <span class="n">plugin</span> <span class="n">settings</span><span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Data</span><span class="o">:</span><span class="n">无参构造</span><span class="err">，</span><span class="n">get</span><span class="err">，</span><span class="n">set</span><span class="err">，</span><span class="n">toString</span><span class="err">，</span><span class="n">hashcode</span><span class="err">，</span><span class="n">equals</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@FieldNameConstants</span>
<span class="nd">@ToString</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="9多对一处理">9、多对一处理</h2>
<p>多对一：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716171244575.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716171244575.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716171244575.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716171244575.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210716171244575.png"
        title="image-20210716171244575" /></p>
<ul>
<li>多个学生，对应一个老师</li>
<li>对于学生这边而言，关联。。对个学生，关联一个老师</li>
<li>对于老师而言，集合，</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716174404362.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716174404362.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716174404362.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210716174404362.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210716174404362.png"
        title="image-20210716174404362" /></p>
<p>绿色：1   蓝色：∞</p>
<p>SQL：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">teacher</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">                           </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">                           </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">                           </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">teacher</span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;秦老师&#39;</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">                           </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">                           </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">                           </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">                           </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">                           </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">fktid</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">                           </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">fktid</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">teacher</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;小红&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;小张&#39;&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;小李&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">student</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">tid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;小王&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="测试环境搭建">测试环境搭建</h3>
<ol>
<li>导入Lombok</li>
<li>新建实体类Teacher，Student</li>
<li>建立Mapper接口</li>
<li>建立Mapper.XML文件</li>
<li>在核心配置文件中绑定注册我们的Mapper接口或者文件！【方式很多，随心选】</li>
<li>测试查询是否能能够成功</li>
</ol>
<h3 id="按照查询嵌套处理">按照查询嵌套处理</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--
</span><span class="c">        思路:
</span><span class="c">            1.查询所有的学生信息
</span><span class="c">            2.根据查询出来的学生的tid，寻找对应的老师! 子查询
</span><span class="c">    --&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudent&#34;</span> <span class="na">resultmap=</span><span class="s">&#34;studentTeacher&#34;</span><span class="nt">&gt;</span>
    select * from student
    <span class="nt">&lt;/se1ect&gt;</span>

<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;StudentTeacher&#34;</span> <span class="na">type=</span><span class="s">&#34;student&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;resu1t</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;resu1t</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!--复杂的属性，我们需要单独处理对象:association集合:collection --&gt;</span>
    <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;teacher&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span> <span class="na">javaType=</span><span class="s">&#34;Teacher&#34;</span> <span class="na">select=</span><span class="s">&#34;getTeacher&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resu1tMap&gt;</span>

<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
    select * from teacher where id = #{id}
<span class="nt">&lt;/select&gt;</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="按照结果嵌套处理">按照结果嵌套处理</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudent2&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;StudentTeacher2&#34;</span><span class="nt">&gt;</span>
    select s.id sid,s.name sname,t.name tname
    from student s,teacher t
    where s.tid = t.id

<span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;StudentTeacher2&#34;</span> <span class="na">type=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;teacher&#34;</span> <span class="na">javaType=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;tname&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
    <span class="nt">&lt;/association&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>回顾Mysql多对一查询方式</p>
<ul>
<li>子查询</li>
<li>联表查询</li>
</ul>
<h2 id="10一对多处理">10、一对多处理</h2>
<p>比如：一个老师拥有多个学生！</p>
<p>对于老师而言就是一对多的关系！</p>
<h3 id="环境搭建">环境搭建</h3>
<ol>
<li>
<p>环境搭建和刚才一样</p>
<p><strong>实体类</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="o">{</span>
    <span class="kd">private</span>  <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">tid</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Teacher</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">//一个老师拥有多个学生
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">students</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="按照过嵌套处理">按照过嵌套处理</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;TeacherStudent&#34;</span><span class="nt">&gt;</span>
    select s.id sid ,s.name sname,t.name tname,t.id tid
    from student s,teacher t
    where s.tid = t.id and t.id = #{tid}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;TeacherStudent&#34;</span> <span class="na">type=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;tname&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;students&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;sid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;sname&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;tid&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/collection&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="按查询嵌套处理">按查询嵌套处理</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher2&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;TeacherStudent2&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.teacher where id = #{tid}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;TeacherStudent2&#34;</span> <span class="na">type=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;students&#34;</span> <span class="na">javaType=</span><span class="s">&#34;ArrayList&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Student&#34;</span> <span class="na">select=</span><span class="s">&#34;getStudentByTeacherId&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>

<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudentByTeacherId&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.student where tid=#{tid}
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>小结</p>
<ol>
<li>关联 - association【多对一】</li>
<li>集合 - collection 【一对多】</li>
<li>javaType &amp; ofType
<ol>
<li>javaType	用来指定实体类中的属性类型</li>
<li>ofType   用来指定映射到List或者集合中的pojo类型中，泛型中的约束类型</li>
</ol>
</li>
</ol>
<p>注意点：</p>
<ul>
<li>保证SQL的可读性，尽量保证通俗易懂</li>
<li>注意一对多和多对一中，属性名和字段的问题</li>
<li>如果问题不好排查错误，可以使用日志。建议使用log4j</li>
</ul>
<p>面试高频</p>
<ul>
<li>Mysql引擎</li>
<li>InnoDB一层原理</li>
<li>索引</li>
<li>索引优化！</li>
</ul>
<h2 id="11动态sql">11、动态SQL</h2>
<p><strong>什么是动态SQL：动态SQL就是根据不同条件生成不同的SQL语句</strong></p>
<p>利用动态SQL这一特性可以彻底摆脱这种痛苦。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">动态SQL元素和JSTL或基于类似XML的文本处理器相似。在MyBatis 之前的版本中，有很多元素需要花时间
了解。MyBatis 3大大精简了元素种类，现在只需学习原来一半的元素便可。MyBatis采用功能强大的基于OGNL
的表达式来淘汰其它大部分元素。
if
choose (when， otherwise)
trim (where， set)
foreach

</code></pre></td></tr></table>
</div>
</div><h3 id="搭建环境">搭建环境</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">blog</span><span class="o">`</span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;博客id&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="o">`</span><span class="n">title</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;博客标题&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;博客作者&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="o">`</span><span class="n">create_time</span><span class="o">`</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;创建时间&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="o">`</span><span class="n">views</span><span class="o">`</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;浏览量&#39;</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>创建一个基础工程</p>
<ol>
<li>
<p>导包</p>
</li>
<li>
<p>编写配置文件</p>
</li>
<li>
<p>编写实体类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Blog</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">author</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">creatTime</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">views</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编写实体类对应的Mapper接口和Mapper.XML文件</p>
</li>
</ol>
<h3 id="if">IF</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;queryBlogIf&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Blog&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.blog where 1=1
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
        and title = #{title}
    <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
        and author = #{author}
    <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="choose-when-otherwise">choose (when， otherwise)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;queryBlogChoose&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Blog&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.blog
    <span class="nt">&lt;where&gt;</span>
        <span class="nt">&lt;choose&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
                title = #{title}
            <span class="nt">&lt;/when&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
                and authot = #{author}
            <span class="nt">&lt;/when&gt;</span>
            <span class="nt">&lt;otherwise&gt;</span>
                and views = #{views}
            <span class="nt">&lt;/otherwise&gt;</span>
        <span class="nt">&lt;/choose&gt;</span>
    <span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="trim-where-settrim可以自定义">trim (where， set)【trim可以自定义】</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="nt">&gt;</span>
        update mybatis.blog
        <span class="nt">&lt;set&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
                title = #{title},
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
                author = #{author},
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/set&gt;</span>
        where id = #{id}
    <span class="nt">&lt;/update&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&lt;trim prefix=&#34;&#34; prefixOverrides=&#34;&#34; suffix=&#34;&#34; suffixOverrides=&#34;&#34;&gt;
    
&lt;/trim&gt;
</code></pre></td></tr></table>
</div>
</div><p><strong>所谓动态SQL，本质还是SQL语句，只是我们可以再SQL层面去执行一些逻辑代码</strong></p>
<p>if</p>
<p>where set  choose  when</p>
<h3 id="sql片段">SQL片段</h3>
<p>有的时候，我们可能会讲一些功能的部分抽取出来，方便复用</p>
<ol>
<li>使用SQL标签抽取的公共部分</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;if-title-author&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
        title = #{title}
    <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
        and author = #{author}
    <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/sql&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>在需要使用的地方使用include标签引用即可</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;queryBlogIf&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Blog&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.blog
    <span class="nt">&lt;where&gt;</span>
       <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;if-title-author&#34;</span><span class="nt">&gt;&lt;/include&gt;</span>
    <span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="foreach">Foreach</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> 
</span><span class="w"></span><span class="o">&lt;</span><span class="n">foreach</span><span class="w"> </span><span class="n">item</span><span class="o">=</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">index</span><span class="o">=</span><span class="s2">&#34;index&#34;</span><span class="w"> </span><span class="n">collection</span><span class="o">=</span><span class="s2">&#34;ids&#34;</span><span class="w">
</span><span class="w">	</span><span class="k">open</span><span class="o">=</span><span class="s2">&#34;(&#34;</span><span class="w"> </span><span class="n">separator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;or&#34;</span><span class="w">  </span><span class="k">close</span><span class="o">=</span><span class="s2">&#34;)&#34;</span><span class="w">
</span><span class="w">	</span><span class="o">#</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="w">
</span><span class="w"></span><span class="o">&lt;/</span><span class="n">foreach</span><span class="o">&gt;</span><span class="w">
</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w">
</span><span class="w">
</span><span class="w">
</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717161103126.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717161103126.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717161103126.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717161103126.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210717161103126.png"
        title="image-20210717161103126" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;queryBlogForeach&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Blog&#34;</span><span class="nt">&gt;</span>
    select * from mybatis.blog

    <span class="nt">&lt;where&gt;</span>
        <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;ids&#34;</span> <span class="na">item=</span><span class="s">&#34;id&#34;</span> <span class="na">open=</span><span class="s">&#34;and (&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;or&#34;</span><span class="nt">&gt;</span>
            id = #{id}
        <span class="nt">&lt;/foreach&gt;</span>
    <span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>动态SQL就是在拼接SQL语句，我们只要保证SQL的正确性，按照SQL的格式，去排列组合就可以了</strong></p>
<p>建议</p>
<ul>
<li>先在Mysql中写出完整的SQL，在对应的去修改成为我们的动态SQL实现通用</li>
</ul>
<h2 id="12缓存">12、缓存</h2>
<h3 id="1简介">1、简介</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">查询 ：链接数据库 ，耗资源
	一次查询的结果，给他暂存一个可以直接取到的地方！--&gt;内存 ：缓存
	
我们再次查询相同的数据的时候，直接走缓存，就不用走数据库了
</code></pre></td></tr></table>
</div>
</div><ol>
<li>什么是缓存[ Cache ]?
<ul>
<li>存在内存中的临时数据。</li>
<li>将用户经常查询的数据放在缓存(内存)中，用户去查询数据就不用从磁盘上(关系型数据库数据文件)查询，从缓存中查询，从而提高查询效率,解决了高并发系统的性能问题。</li>
</ul>
</li>
<li>为什么使用缓存?
<ul>
<li>减少和数据库的交互次数,减少系统开销,提高系统效率。</li>
</ul>
</li>
<li>什么样的数据能使用缓存?
<ul>
<li>经常查询并且不经常改变的数据。【可以使用缓存】</li>
</ul>
</li>
</ol>
<h3 id="2mybatis缓存">2、Mybatis缓存</h3>
<ul>
<li>MyBatis包含一个非常强大的查询缓存特性，它可以非常方便地定制和配置缓存。缓存可以极大的提升查询效
率。</li>
<li>MyBatis系统中默认定义了两级缓存: <strong>一级缓存</strong>和<strong>二级缓存</strong>
<ul>
<li>默认情况下，只有一-级缓存开启。 (SqlSession级别的缓存， 也称为本地缓存)</li>
<li>二级缓存需要手动开启和配置， 他是基于namespace级别的缓存。</li>
<li>为了提高扩展性, MyBatis定义了缓存接口Cache。我们可以通过实现Cache接口来自定义二级缓存</li>
</ul>
</li>
</ul>
<h3 id="3一级缓存">3、一级缓存</h3>
<ul>
<li>一级缓存也叫本地缓存: SqlSession
<ul>
<li>与数据库同一次会话期间查询到的数据会放在本地缓存中。</li>
<li>以后如果需要获取相同的数据，直接从缓存中拿，没必须再去查询数据库;</li>
</ul>
</li>
</ul>
<p>测试步骤：</p>
<ol>
<li>
<p>开启日志</p>
</li>
<li>
<p>测试在一个Session中查询两次相同的记录</p>
</li>
<li>
<p>查看日志输出</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717175732648.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717175732648.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717175732648.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717175732648.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210717175732648.png"
        title="image-20210717175732648" /></p>
</li>
</ol>
<p>缓存失效的情况</p>
<ol>
<li>
<p>查询不同的东西</p>
</li>
<li>
<p>增删改操作，可能会改变原来的数据，所以必定会刷新缓存！</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717180544621.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717180544621.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717180544621.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717180544621.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210717180544621.png"
        title="image-20210717180544621" /></p>
</li>
<li>
<p>查询不同的Mapper.xml</p>
</li>
<li>
<p>手动清理缓存！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MybatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">UserMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">queryUserById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

    <span class="n">sqlSession</span><span class="o">.</span><span class="na">clearCache</span><span class="o">();</span><span class="c1">//手动清理缓存
</span><span class="c1"></span>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;=========================&#34;</span><span class="o">);</span>

    <span class="n">User</span> <span class="n">user2</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">queryUserById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user2</span><span class="o">);</span>



    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">==</span><span class="n">user2</span><span class="o">);</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>小结：一级缓存默认是开启的，只有在一次SqlSession中有效，也就是拿到链接到关闭连接这个区间段！</p>
<p>一级缓存就是一个Map</p>
<h3 id="4-二级缓存">4、 二级缓存</h3>
<ul>
<li>二级缓存也叫全局缓存，一级缓存作用域太低了，所以诞生了二级缓存</li>
<li>基于namespace级别的缓存， 一个名称空间，对应一 个二级缓存</li>
<li>工作机制
<ul>
<li>个会话查询一条数据，这个数据就会被放在当前会话的- -级缓存中</li>
<li>如果当前会话关闭了，这个会话对应的一级缓存就没了;但是我们想要的是，会话关闭了，一级缓存中的数据被保存到二级缓存中</li>
<li>新的会话查询信息，就可以从二级缓存中获取内容;</li>
<li>不同的mapper查出的数据会放在自己对应的缓存(map)中</li>
</ul>
</li>
</ul>
<p>步骤：</p>
<ol>
<li>
<p>开启全局缓存</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--        显示的开启全局缓存--&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>xxxxxxxxxx2 1<span class="c">&lt;!--        显示的开启全局缓存--&gt;</span>2        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>再要使用deMapper中开启</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--        在当前xml中使用缓存--&gt;</span>
<span class="nt">&lt;cache/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>也可以自定义参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;cache</span> <span class="na">eviction=</span><span class="s">&#34;FIFO&#34;</span>
       <span class="na">flushInterval=</span><span class="s">&#34;60000&#34;</span>
       <span class="na">size=</span><span class="s">&#34;512&#34;</span>
       <span class="na">readOnly=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>
<p>测试</p>
</li>
<li>
<p>问题：我们需要将实体类序列化！否则就会报错！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Caused</span> <span class="n">by</span><span class="o">:</span> <span class="n">java</span><span class="o">.</span> <span class="n">io</span><span class="o">.</span> <span class="n">NotSerializableExcepti</span> <span class="n">on</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">miaobuyi</span><span class="o">.</span><span class="na">pojo</span><span class="o">.</span><span class="na">user</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>小结：</p>
<ul>
<li>只要开启了二级缓存，在同一个Mapper下就有效</li>
<li>所有的数据都会先放在一级缓存中</li>
<li>只有当回话提交或者关闭的时候，才会提交到二级缓存中！</li>
</ul>
<h3 id="5缓存原理">5、缓存原理</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717191347109.png"
        data-srcset="C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717191347109.png, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717191347109.png 1.5x, C:%5cUsers%5c%e6%9d%a8%e5%ae%87%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20210717191347109.png 2x"
        data-sizes="auto"
        alt="C:\Users\杨宇\AppData\Roaming\Typora\typora-user-images\image-20210717191347109.png"
        title="image-20210717191347109" /></p>
<h3 id="6自定义缓存-ehcache">6、自定义缓存-ehcache</h3>
<p>Redis数据库来做缓存！ K-V</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-09-21</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/mybatis/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis" data-via="xxxx" data-hashtags="Mybatis"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://miaobuyi.web/mybatis/" data-hashtag="Mybatis"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://miaobuyi.web/mybatis/" data-title="Mybatis"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/mybatis/">Mybatis</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" class="prev" rel="prev" title="设计模式"><i class="fas fa-angle-left fa-fw"></i>设计模式</a>
            <a href="/springmvc/" class="next" rel="next" title="SpringMVC">SpringMVC<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.88.1">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">喵不易</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
